<div>
  <h1>⚙️ WSUS Management Tools</h1>

  <h2>📝 Overview</h2>
  <p>
    The <strong>WSUS Management Tools</strong> repository provides a curated set of <strong>PowerShell scripts</strong> for automating, maintaining, and optimizing Windows Server Update Services (WSUS) and its underlying <strong>SUSDB (Windows Internal Database)</strong>. 
    These tools are tailored for Active Directory environments and support both standalone and enterprise deployments.
  </p>

  <h3>✅ Key Features</h3>
  <ul>
    <li><strong>Graphical Interface:</strong> User-friendly GUI for WSUS administrators to execute routine tasks without using the command line.</li>
    <li><strong>Index Optimization:</strong> Automatically generates SQL reindex scripts for fragmented WSUS database indexes.</li>
    <li><strong>Assembly Detection:</strong> Verifies whether WSUS Admin assemblies are correctly loaded from the Global Assembly Cache (GAC).</li>
    <li><strong>Centralized Logging:</strong> Structured <code>.log</code> and <code>.csv</code> outputs for documentation and audit purposes.</li>
    <li><strong>Modular Design:</strong> Scripts are standalone and can be used independently or scheduled for automation.</li>
  </ul>

  <hr />

  <h2>🛠️ Prerequisites</h2>
  <ol>
    <li>
      <strong>⚙️ PowerShell:</strong>
      <ul>
        <li>Requires PowerShell version 5.1 or later.</li>
        <li>To verify:
          <pre><code>$PSVersionTable.PSVersion</code></pre>
        </li>
      </ul>
    </li>
    <li>
      <strong>🔑 Administrator Privileges:</strong>
      <p>Scripts must be run with elevated privileges to access WSUS APIs and SUSDB functions.</p>
    </li>
    <li>
      <strong>📦 Required Modules:</strong>
      <ul>
        <li><code>UpdateServices</code> – installed with the WSUS Administration Console.</li>
        <li><code>ActiveDirectory</code> – optional, used for WSUS server discovery in the forest.</li>
      </ul>
    </li>
    <li>
      <strong>🗃 SQLCMD Tools:</strong>
      <ul>
        <li>Required for executing SQL queries against the SUSDB using named pipes.</li>
        <li>Ensure <code>sqlcmd.exe</code> is available in the system PATH or specified manually in the script.</li>
      </ul>
    </li>
    <li>
      <strong>🔧 Execution Policy:</strong>
      <pre><code>Set-ExecutionPolicy -Scope Process -ExecutionPolicy RemoteSigned</code></pre>
    </li>
    <li>
      <strong>📂 SQL Script Files:</strong>
      <ul>
        <li><code>C:\Scripts\wsus-reindex.sql</code> (generated by <code>Generate-WSUSReindexScript.ps1</code>)</li>
        <li><code>C:\Scripts\wsus-verify-fragmentation.sql</code></li>
      </ul>
    </li>
    <li>
      <strong>🧩 WSUS Admin Assembly:</strong>
      <p>Ensure that <code>Microsoft.UpdateServices.Administration.dll</code> is registered in the Global Assembly Cache (GAC).</p>
      <p>Use <code>Check-WSUS-AdminAssembly.ps1</code> to validate the assembly presence and load status.</p>
    </li>
  </ol>

  <hr />

  <h2>📜 Script Descriptions (Alphabetical Order)</h2>
  <table border="1" style="border-collapse: collapse; width: 100%;">
    <thead>
      <tr>
        <th style="padding: 8px;">Script Name</th>
        <th style="padding: 8px;">Function</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Check-WSUS-AdminAssembly.ps1</strong></td>
        <td>Checks whether <code>Microsoft.UpdateServices.Administration.dll</code> is loaded from the GAC. Prompts to install WSUS Console if missing.</td>
      </tr>
      <tr>
        <td><strong>Generate-WSUSReindexScript.ps1</strong></td>
        <td>Connects to SUSDB using SQLCMD and generates <code>wsus-reindex.sql</code> for indexes with fragmentation above 10% and over 100 pages.</td>
      </tr>
      <tr>
        <td><strong>Maintenance-WSUS-Admin-Tool.ps1</strong></td>
        <td>Comprehensive GUI tool for WSUS maintenance. Handles update declines (superseded, expired, unapproved), WSUS cleanup, WID database tasks (checkdb, shrink, reindex), and exports declined updates to CSV.</td>
      </tr>
    </tbody>
  </table>

  <hr />

  <h2>🚀 Usage Instructions</h2>
  <ol>
    <li><strong>Run the Script:</strong> Right-click the desired <code>.ps1</code> file and select <em>Run with PowerShell</em> as Administrator.</li>
    <li><strong>Select Maintenance Options:</strong> Use GUI checkboxes or edit parameters within the script as needed.</li>
    <li><strong>Check Logs:</strong> Review logs in <code>$env:ProgramData\WSUS-GUI\Logs</code> or your configured log directory.</li>
  </ol>

  <hr />

  <h2>📁 Complementary Files</h2>
  <ul>
    <li><strong>wsus-reindex-EXAMPLE.sql:</strong> Sample SQL script for index rebuilds (generated by <code>Generate-WSUSReindexScript.ps1</code>).</li>
    <li><strong>wsus-verify-fragmentation.sql:</strong> SQL query to analyze fragmentation levels in SUSDB indexes.</li>
  </ul>

  <hr />

  <h2>💡 Optimization Tips</h2>
  <ul>
    <li><strong>Leverage GPO Scheduling:</strong> Automate maintenance using Task Scheduler or GPO-based startup scripts.</li>
    <li><strong>Centralize Logging:</strong> Adjust the <code>$logDir</code> variable in scripts to output logs to a shared location.</li>
    <li><strong>Adapt Paths Per Environment:</strong> Customize values for <code>$sqlcmd</code>, <code>$namedPipe</code>, and script paths as needed.</li>
    <li><strong>Use Staging First:</strong> Validate WSUS cleanup and database changes in a test environment before deploying to production.</li>
  </ul>
</div>
