<?xml version="1.0" encoding="utf-8"?>
<package xmlns="http://schemas.microsoft.com/packaging/2010/07/nuspec.xsd">
  <metadata>
    <id>sysadmin-prosuite</id>
    <version>1.0.0</version>
    <authors>brazilianscriptguy</authors>
    <owners>brazilianscriptguy</owners>
    <requireLicenseAcceptance>false</requireLicenseAcceptance>
    <license type="file">LICENSE.txt</license>
    <description>
      Comprehensive suite of tools for Windows Server Administration and Workstation ITSM Templates, including AD, SSO, GPOs, Logging, Incident Response, and NuGet packaging.
    </description>
    <tags>SysAdmin ITSM PowerShell AD GPO SSO VBScript Windows NuGet</tags>
    <readme>README.md</readme>
    <projectUrl>https://github.com/brazilianscriptguy/Windows-SysAdmin-ProSuite</projectUrl>
    <icon>icon.png</icon>
    <repository type="git" url="https://github.com/brazilianscriptguy/Windows-SysAdmin-ProSuite" />
  </metadata>
  <files>
    <file src="SysAdmin-Tools\**\*.*" target="tools\SysAdmin-Tools" />
    <file src="SysAdmin-Tools\README.md" target="docs\SysAdmin-Tools\README.md" />

    <file src="ITSM-Templates-WKS\**\*.*" target="tools\ITSM-Templates-WKS" />
    <file src="ITSM-Templates-WKS\README.md" target="docs\ITSM-Templates-WKS\README.md" />
    <file src="ITSM-Templates-WKS\JUNE-19-2025-ITSM-Templates Application Guide for Windows 10 and 11.pdf" target="docs\ITSM-Templates-WKS" />

    <file src="ITSM-Templates-SVR\**\*.*" target="tools\ITSM-Templates-SVR" />
    <file src="ITSM-Templates-SVR\README.md" target="docs\ITSM-Templates-SVR\README.md" />

    <file src="Core-ScriptLibrary\**\*.*" target="tools\Core-ScriptLibrary" />
    <file src="Core-ScriptLibrary\README.md" target="docs\Core-ScriptLibrary\README.md" />

    <file src="BlueTeam-Tools\**\*.*" target="tools\BlueTeam-Tools" />
    <file src="BlueTeam-Tools\README.md" target="docs\BlueTeam-Tools\README.md" />
  </files>
</package>
```

---

**File 2: `.github/workflows/publish-nuget.yml`**

```yaml
name: Publish NuGet Package to GitHub

on:
  push:
    branches: [main]
  release:
    types: [published, prerelease]

permissions:
  contents: write
  packages: write

jobs:
  publish-nuget:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          submodules: recursive

      - name: Install dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y mono-complete xmlstarlet
          wget -O nuget.exe https://dist.nuget.org/win-x86-commandline/v6.11.0/nuget.exe
          chmod +x nuget.exe
          sudo mv nuget.exe /usr/local/bin/nuget

      - name: Prepare and stage files
        run: |
          pkg="sysadmin-prosuite"
          nuspec="$pkg.nuspec"
          mkdir -p nupkg-out "tmp-$pkg"

          for dir in BlueTeam-Tools Core-ScriptLibrary ITSM-Templates-SVR ITSM-Templates-WKS SysAdmin-Tools; do
            if [ -d "$dir" ]; then
              cp -r "$dir/." "tmp-$pkg/$dir/"
            fi
          done

          cp "$nuspec" "tmp-$pkg/$pkg.nuspec"
          cp README.md "tmp-$pkg/README.md" || { echo "README.md not found"; exit 1; }
          cp LICENSE.txt "tmp-$pkg/LICENSE.txt" || { echo "LICENSE.txt not found"; exit 1; }
          cp icon.png "tmp-$pkg/icon.png" || true

      - name: Pack NuGet package
        run: |
          pkg="sysadmin-prosuite"
          cd "tmp-$pkg"
          mono /usr/local/bin/nuget pack "$pkg.nuspec" \
            -OutputDirectory ../nupkg-out \
            -NonInteractive

      - name: Push to GitHub Packages
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          for pkg_path in nupkg-out/*.nupkg; do
            [ -f "$pkg_path" ] && mono /usr/local/bin/nuget push "$pkg_path" \
              -Source "https://nuget.pkg.github.com/${{ github.repository_owner }}/index.json" \
              -ApiKey "$GITHUB_TOKEN" -NonInteractive -SkipDuplicate
          done

      - name: Clean up
        if: always()
        run: |
          rm -rf "tmp-sysadmin-prosuite" nupkg-out || true
