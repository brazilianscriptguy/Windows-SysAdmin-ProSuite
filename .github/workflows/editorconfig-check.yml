name: EditorConfig Check

on:
  push:
    branches: [main, develop]
    paths:
      - '.editorconfig'
      - '**/.editorconfig'
      - '**/*.{ps1,psm1,psd1,vbs,hta,xml,json,jsonc,yaml,yml,toml,md,rst,txt,csv,log,env,reg,html,config,nuspec,csproj,ini,conf,sh,bash,bat,cmd,eslintrc,eslintrc.json,stylelintrc,prettierrc,prettierrc.json,lock}'

  pull_request:
    branches: [main, develop]
    paths:
      - '.editorconfig'
      - '**/.editorconfig'
      - '**/*.{ps1,psm1,psd1,vbs,hta,xml,json,jsonc,yaml,yml,toml,md,rst,txt,csv,log,env,reg,html,config,nuspec,csproj,ini,conf,sh,bash,bat,cmd,eslintrc,eslintrc.json,stylelintrc,prettierrc,prettierrc.json,lock}'

  workflow_dispatch:

jobs:
  editorconfig-check:
    name: üîç EditorConfig Lint
    runs-on: ubuntu-latest

    steps:
      - name: üì¶ Checkout Repository
        uses: actions/checkout@v4.1.1

      - name: üì• Download EditorConfig Checker
        run: |
          wget -q https://github.com/editorconfig-checker/editorconfig-checker/releases/latest/download/ec-linux-amd64.tar.gz
          mkdir -p ec-checker
          tar -xzf ec-linux-amd64.tar.gz -C ec-checker
          chmod +x ec-checker/ec || chmod +x ec-checker/ec-linux-amd64 || true
          if [ -f ec-checker/ec ]; then
            sudo mv ec-checker/ec /usr/local/bin/ec
          elif [ -f ec-checker/ec-linux-amd64 ]; then
            sudo mv ec-checker/ec-linux-amd64 /usr/local/bin/ec
          else
            echo "‚ùå Error: ec binary not found after extraction"
            exit 1
          fi

      - name: ‚ñ∂Ô∏è Run EditorConfig Checker
        run: |
          ec --version
          ec --disable-logs || true  # Do not fail if stylistic violations exist
