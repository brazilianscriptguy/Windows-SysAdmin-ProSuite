name: Manual Keyword Search in Repository

on:
  workflow_dispatch:
    inputs:
      search_term:
        description: "Term to search for across the repository"
        required: true
        default: "TODO"

jobs:
  search-keyword:
    name: Search Keyword in Files
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4.2.2

      - name: Initialize search term
        run: |
          echo "SEARCH_TERM=${{ github.event.inputs.search_term }}" >> "$GITHUB_ENV"

      - name: Search for keyword in repository
        run: |
          echo "ðŸ” Searching for '${SEARCH_TERM}' in repository files..."
          grep -rIn --exclude-dir=.git --color=never "${SEARCH_TERM}" . || \
          echo "âœ… No matches found for '${SEARCH_TERM}'."

      - name: Save matches to artifact
        run: |
          mkdir -p results
          grep -rIn --exclude-dir=.git --color=never "${SEARCH_TERM}" . > results/matches.txt || true

      - name: Upload search results
        uses: actions/upload-artifact@v4
        with:
          name: keyword-search-results
          path: results/matches.txt
